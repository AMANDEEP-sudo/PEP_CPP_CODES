// ...existing code from 2d_matrix.cpp...